# Анализ миграции на Tauri

## Текущий размер Electron приложения

### Компоненты размера

**Electron Runtime:**
- Electron 39.2.4: ~120-150 MB (Chromium + Node.js)
- Main process: ~5-10 MB (собранный код)
- Preload scripts: ~1-2 MB
- Renderer bundle: ~5-15 MB (React + зависимости)

**Итого Electron:**
- Windows portable: **~130-180 MB**
- Linux AppImage: **~140-190 MB**
- macOS dmg: **~150-200 MB**

### Зависимости проекта

**Основные зависимости (влияют на размер bundle):**
- React 19.2.0 + React DOM: ~150 KB (gzipped)
- React Router 7.9.6: ~20 KB
- React Query 5.90.11: ~30 KB
- Framer Motion 12.23.24: ~50 KB
- Zustand 5.0.8: ~5 KB
- Axios 1.13.2: ~15 KB
- Lucide React 0.555.0: ~100 KB (tree-shaken)
- Recharts 3.4.1: ~200 KB (с d3)
- TailwindCSS: ~10 KB (purged)

**Итого bundle (оптимизированный):**
- JavaScript: ~500-700 KB (gzipped)
- CSS: ~50-100 KB
- Assets: зависит от иконок, изображений

## Размер Tauri приложения

### Компоненты размера

**Tauri Runtime:**
- Tauri core (Rust binary): **~2-5 MB** (зависит от включенных features)
- System WebView: **0 MB** (используется системный)
- Frontend bundle: **~500-700 KB** (тот же React bundle)

**Итого Tauri:**
- Windows: **~3-8 MB** (без WebView, т.к. встроен в Windows 10+)
- Linux: **~5-15 MB** (может потребоваться WebView, если не установлен)
- macOS: **~3-8 MB** (WebView встроен в macOS)

### Сравнение размеров

| Платформа | Electron | Tauri | Экономия |
|-----------|----------|-------|----------|
| Windows   | 130-180 MB | 3-8 MB | **~95-97%** |
| Linux     | 140-190 MB | 5-15 MB | **~90-95%** |
| macOS     | 150-200 MB | 3-8 MB | **~95-97%** |

## Детальный анализ

### Что останется одинаковым

1. **Frontend bundle** (~500-700 KB):
   - React и все зависимости
   - Ваш код приложения
   - CSS и assets
   - Размер не изменится

2. **Логика приложения**:
   - Вся бизнес-логика React
   - API клиенты
   - State management
   - Роутинг

### Что изменится

1. **Runtime:**
   - Electron (Chromium + Node.js): ~120-150 MB
   - Tauri (Rust binary): ~2-5 MB
   - **Экономия: ~115-145 MB**

2. **Main process:**
   - Electron: Node.js процесс с полным доступом к Node.js API
   - Tauri: Rust процесс с ограниченным API через команды
   - Размер кода: примерно одинаковый (~5-10 MB исходного кода)

3. **IPC коммуникация:**
   - Electron: `ipcRenderer` / `ipcMain`
   - Tauri: `invoke` / `command` (аналогично, но типизировано через Rust)

## Оценка размера для вашего проекта

### Текущий Electron (оценка)

```
Electron Runtime:        ~140 MB
Main process code:       ~8 MB
Preload scripts:         ~2 MB
Frontend bundle:         ~10 MB (uncompressed)
Assets:                  ~2 MB
─────────────────────────────────
Итого:                   ~162 MB
```

### Будущий Tauri (оценка)

```
Tauri Runtime:           ~4 MB (Rust binary)
Frontend bundle:         ~10 MB (uncompressed)
Assets:                  ~2 MB
─────────────────────────────────
Итого:                   ~16 MB
```

**Экономия: ~146 MB (90% уменьшение)**

## Особенности миграции

### Что нужно будет переписать

1. **Main process (`electron/main.ts` → `src-tauri/src/main.rs`):**
   - ~2600 строк TypeScript → Rust
   - Все файловые операции
   - Запуск Java процессов
   - HTTP запросы
   - Уведомления
   - Обновления лаунчера

2. **Preload (`electron/preload.ts`):**
   - Заменяется на Tauri команды
   - API будет типизирован через Rust

3. **IPC вызовы:**
   - `ipcRenderer.invoke()` → `invoke('command_name')`
   - Типизация через Rust типы

### Что останется без изменений

1. **Frontend код:**
   - Все React компоненты
   - Все страницы
   - State management (Zustand)
   - API клиенты (axios)
   - Роутинг

2. **Структура проекта:**
   - `packages/frontend/src/` - без изменений
   - `packages/shared/` - без изменений
   - `packages/backend/` - без изменений

## Оценка трудозатрат на миграцию

### Основные задачи

1. **Переписать main process на Rust** (~2-3 недели):
   - Файловые операции
   - Запуск процессов
   - HTTP клиент
   - IPC команды

2. **Обновить frontend IPC вызовы** (~1 неделя):
   - Заменить `window.electronAPI` на `invoke()`
   - Обновить типы
   - Протестировать все функции

3. **Настроить сборку** (~3-5 дней):
   - Tauri конфигурация
   - CI/CD обновление
   - Тестирование на всех платформах

4. **Тестирование** (~1-2 недели):
   - Функциональное тестирование
   - Тестирование на разных ОС
   - Исправление багов

**Итого: ~5-7 недель разработки**

## Преимущества Tauri

1. **Размер:**
   - ✅ 90-95% меньше размер приложения
   - ✅ Быстрее скачивание и установка
   - ✅ Меньше места на диске

2. **Производительность:**
   - ✅ Меньше потребление памяти (нет Chromium)
   - ✅ Быстрее запуск (Rust binary)
   - ✅ Лучшая производительность Rust кода

3. **Безопасность:**
   - ✅ Меньше поверхность атаки
   - ✅ Rust безопасность памяти
   - ✅ Системный WebView (обновляется ОС)

4. **Разработка:**
   - ✅ Типизация через Rust (compile-time проверки)
   - ✅ Лучшая производительность нативных операций

## Недостатки Tauri

1. **Сложность миграции:**
   - ❌ Нужно переписать main process на Rust
   - ❌ Другая экосистема и инструменты
   - ❌ Меньше документации и примеров

2. **Ограничения:**
   - ❌ Меньше нативных API (но достаточно для лаунчера)
   - ❌ WebView должен быть установлен (на Linux может быть проблемой)
   - ❌ Меньше готовых решений для специфичных задач

3. **Экосистема:**
   - ❌ Меньше плагинов и расширений
   - ❌ Меньше примеров для сложных сценариев
   - ❌ Меньше разработчиков с опытом Tauri

## Рекомендации

### Когда стоит мигрировать на Tauri

✅ **Стоит мигрировать, если:**
- Размер приложения критичен
- Нужна лучшая производительность
- Готовы инвестировать время в миграцию
- Команда готова изучать Rust

❌ **Не стоит мигрировать, если:**
- Размер приложения не критичен
- Нужно быстро выпускать фичи
- Нет ресурсов на миграцию
- Команда не знает Rust

### Альтернативный подход

Можно оптимизировать текущее Electron приложение:

1. **Использовать Electron Forge** для лучшей оптимизации
2. **Удалить неиспользуемые зависимости**
3. **Оптимизировать bundle** (tree-shaking, code splitting)
4. **Использовать Electron-updater** для delta updates
5. **Сжать ресурсы** (иконки, изображения)

Это может уменьшить размер на 20-30% без миграции.

## Вывод

**Размер Tauri приложения: ~3-8 MB** (вместо ~130-180 MB Electron)

**Экономия: ~90-95% размера**

**Трудозатраты на миграцию: ~5-7 недель**

**Рекомендация:** Если размер критичен и есть ресурсы - мигрируйте. Если нет - оптимизируйте Electron.

